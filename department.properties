spring.application.name=Department-Managment-Service
# ===============================
# = MySQL DataSource
# ===============================
spring.datasource.url=jdbc:mysql://localhost:3306/microservicerevision?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
spring.datasource.username=root
spring.datasource.password=root
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# ===============================
# = JPA / Hibernate
# ===============================
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

server.port=8083

# ========== Zipkin Tracing ==========
management.tracing.sampling.probability=1.0
management.zipkin.tracing.endpoint=http://localhost:9411/api/v2/spans

# ===============================
# Feign + Circuit Breaker Enabled
# ===============================

# Enable Feign circuit breaker
spring.cloud.openfeign.circuitbreaker.enabled=true
# ===============================
# Resilience4j Circuit Breaker
# ===============================
resilience4j.circuitbreaker.instances.employeeService.register-health-indicator=true
resilience4j.circuitbreaker.instances.employeeService.sliding-window-size=10
resilience4j.circuitbreaker.instances.employeeService.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.employeeService.wait-duration-in-open-state=10s
resilience4j.circuitbreaker.instances.employeeService.permitted-number-of-calls-in-half-open-state=3

# ===============================
# Resilience4j Retry
# ===============================
resilience4j.retry.instances.employeeService.max-attempts=3
resilience4j.retry.instances.employeeService.wait-duration=2s
resilience4j.retry.instances.employeeService.enable-exponential-backoff=true
resilience4j.retry.instances.employeeService.exponential-backoff-multiplier=2

# ===============================
# Resilience4j Rate Limiter
# ===============================
resilience4j.ratelimiter.instances.employeeService.limit-for-period=5
resilience4j.ratelimiter.instances.employeeService.limit-refresh-period=10s
resilience4j.ratelimiter.instances.employeeService.timeout-duration=2s

# ===============================
# Logging (optional, for debugging)
# ===============================
logging.level.io.github.resilience4j=DEBUG
logging.level.org.springframework.cloud.openfeign=DEBUG
# ==============================================
# ðŸ”¹ Logging with Trace IDs (Micrometer tracing)
# ==============================================
# Add traceId and spanId to every log line
logging.pattern.level=%5p [${spring.application.name},traceId=%X{traceId:-},spanId=%X{spanId:-}]
